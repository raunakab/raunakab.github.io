{% import "macros/page.html" as page_macros %}
{% extends "base.html" %}

{% block content %}
<main id="main" class="index" tabindex="-1">
    <section>
        {% set banner = resize_image(path="/static/main.jpg", width=672, op="fit_width") %}
        <img src="{{ banner.url }}" class="index-banner" alt="Me hiking."/>
    </section>

    <section class="index-columns">
        {% for subsec in config.extra.menu_items | filter(attribute="show_recent", value=true) %}
            <section class="index-listing">
                <!-- Recent Projects, Recent Blog Posts, etc. -->
                <h2 class="transkey">
                    {{ trans(key=subsec.recent_trans_key, lang=lang) | markdown | safe }}
                </h2>

                {% if section.subsections is containing(subsec.name ~ "/_index." ~ lang ~ ".md") %}
                    {% set subsec_path = subsec.name ~ "/_index." ~ lang ~ ".md" %}
                    {% set subsec_link_path = lang ~ "/" ~ subsec.name ~ "/" %}
                {% else %}
                    {% set subsec_path = subsec.name ~ "/_index.md" %}
                    {% set subsec_link_path = subsec.name ~ "/" %}
                {% endif %}

                {% set subsec_section = get_section(path=subsec_path) %}
                {% for page in subsec_section.pages | slice(end=subsec.recent_items) %}
                    {{ page_macros::base_listing(page=page) }}
                {% endfor %}
            </section>
        {% endfor %}
    </section>
</main>
{% endblock content %}
